<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– JetBot ë„ë¡œ ì£¼í–‰ í”„ë¡œì íŠ¸ v3 (CORS ìµœì¢… ìˆ˜ì • ì‹œë„)</title>
    <style>
        /* --- ê¸°ë³¸ ìŠ¤íƒ€ì¼ --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.7;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
            color: #343a40;
        }

        .container {
            max-width: 1000px;
            margin: 30px auto;
            padding: 30px;
            background-color: #ffffff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        /* --- ì œëª© ìŠ¤íƒ€ì¼ --- */
        h1, h2, h3, h4 {
            color: #0b3d91;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            font-weight: 600;
        }
        h1 { text-align: center; border-bottom: 3px solid #76b900; }
        h2 { border-bottom: 2px solid #76b900; margin-top: 2.5rem; }
        h3 { border-bottom: 1px dashed #ced4da; margin-top: 2rem; }
        h4 { color: #17a2b8; margin-top: 1.5rem; font-weight: 500;}

        /* --- ì½”ë“œ ë¸”ë¡ --- */
        pre {
            background-color: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #3e4451;
            font-size: 0.9em;
            line-height: 1.5;
        }
        code {
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
        }
        pre code { background-color: transparent; padding: 0; }
        :not(pre) > code {
            background-color: #e9ecef;
            color: #c82c7a;
            padding: 0.2em 0.5em;
            margin: 0 0.1em;
            font-size: 85%;
            border-radius: 4px;
            font-weight: 500;
        }

        /* --- ê¸°íƒ€ ìš”ì†Œ --- */
        strong { color: #28a745; font-weight: 600; }
        ul, ol { margin-left: 25px; padding-left: 0; }
        li { margin-bottom: 12px; }
        a { color: #007bff; text-decoration: none; font-weight: 500; }
        a:hover { text-decoration: underline; color: #0056b3; }
        hr { border: 0; height: 1px; background-color: #dee2e6; margin: 45px 0; }
        .emoji { margin-right: 7px; vertical-align: -0.1em; }
        blockquote {
            border-left: 4px solid #76b900;
            padding-left: 15px; margin: 20px 0; color: #495057;
            background-color: #f1f3f5; padding-top: 10px; padding-bottom: 10px;
            border-radius: 0 4px 4px 0;
        }
        .warning { color: #dc3545; font-weight: bold; }
        .tip { color: #17a2b8; font-weight: bold; }

        /* --- 3D ë·°ì–´ ì»¨í…Œì´ë„ˆ --- */
        #viewer-container {
            width: 100%; height: 550px; margin: 30px 0;
            border: 1px solid #ced4da; position: relative;
            background-color: #e9ecef; border-radius: 5px; overflow: hidden;
        }
        #loading-indicator {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 1.3em; color: #495057; background-color: rgba(255, 255, 255, 0.85);
            padding: 12px 24px; border-radius: 5px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            text-align: center;
        }

        /* --- ì„¹ì…˜ êµ¬ë¶„ --- */
        .section { margin-bottom: 45px; }

        /* --- ë°˜ì‘í˜• ë””ìì¸ --- */
        @media (max-width: 768px) {
            .container { margin: 15px; padding: 20px; }
            #viewer-container { height: 450px; }
            h1 { font-size: 1.8em; } h2 { font-size: 1.5em; }
            pre { padding: 15px; }
        }
    </style>
</head>
<body>
    <div class="container">

        <h1><span class="emoji">ğŸ¤–</span> JetBot ë„ë¡œ ì£¼í–‰ í”„ë¡œì íŠ¸: ì™„ì „ ì •ë³µ ê°€ì´ë“œ</h1>
        <p style="text-align: center; font-size: 1.1em; color: #6c757d;">ë°ì´í„° ìˆ˜ì§‘ë¶€í„° TensorRT ìµœì í™”, ì‹¤ì‹œê°„ ë°ëª¨ê¹Œì§€! (ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ– 3D ëª¨ë¸ í¬í•¨)</p>

        <hr>

        <div class="section">
            <h2><span class="emoji">âœ¨</span> JetBot 3D ëª¨ë¸ ë¯¸ë¦¬ë³´ê¸°</h2>
            <p>í”„ë¡œì íŠ¸ì˜ ì£¼ì¸ê³µ, JetBotì˜ 3D ëª¨ë¸ì„ ì§ì ‘ ì‚´í´ë³´ì„¸ìš”! ë§ˆìš°ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•„ë˜ ë·°ì–´ì—ì„œ ììœ ë¡­ê²Œ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <ul>
                <li><span class="emoji">ğŸ”„</span> <strong>íšŒì „:</strong> ë§ˆìš°ìŠ¤ ì™¼ìª½ ë²„íŠ¼ í´ë¦­ + ë“œë˜ê·¸</li>
                <li><span class="emoji">ğŸ”</span> <strong>í™•ëŒ€/ì¶•ì†Œ:</strong> ë§ˆìš°ìŠ¤ íœ  ìŠ¤í¬ë¡¤</li>
                <li><span class="emoji">ğŸ–ï¸</span> <strong>ì´ë™(íŒ¨ë‹):</strong> ë§ˆìš°ìŠ¤ ì˜¤ë¥¸ìª½ ë²„íŠ¼ í´ë¦­ + ë“œë˜ê·¸ (ë˜ëŠ” Ctrl/Cmd + ì™¼ìª½ ë²„íŠ¼ í´ë¦­ + ë“œë˜ê·¸)</li>
            </ul>
            <div id="viewer-container">
                <div id="loading-indicator">â³ JetBot ëª¨ë¸ ë¡œë”© ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!</div>
            </div>
             <blockquote class="tip"><span class="emoji">ğŸ’¡</span> ëª¨ë¸ ë¡œë”© ë°©ì‹: GitHub Raw URLì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì¸í„°ë„· ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤. CORS ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ GitHub Pagesë‚˜ ë‹¤ë¥¸ ì •ì  í˜¸ìŠ¤íŒ… ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì´ ë” ì•ˆì •ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì˜ˆì œëŠ” GitHub Raw ì ‘ê·¼ì„ ì‹œë„í•©ë‹ˆë‹¤.</blockquote>
        </div>

        <hr>

        <!-- ì´í•˜ ë¬¸ì„œ ë‚´ìš©ì€ ì´ì „ ë‹µë³€ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€ë©ë‹ˆë‹¤. -->
        <!-- Project Overview -->
        <div class="section" id="project-overview">
            <h2><span class="emoji">ğŸ¯</span> 1. í”„ë¡œì íŠ¸ ê°œìš”: JetBot, ìŠ¤ìŠ¤ë¡œ ê¸¸ì„ ì°¾ë‹¤!</h2>
             <p>ì´ ë¬¸ì„œëŠ” NVIDIA JetBotì´ ì¹´ë©”ë¼(<span class="emoji">ğŸ“·</span>)ë¡œ ì„¸ìƒì„ ë³´ê³ , ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•˜ì—¬ ë„ë¡œ(ë˜ëŠ” ì§€ì •ëœ íŠ¸ë™)ë¥¼ ë”°ë¼ ì£¼í–‰í•˜ëŠ” <strong>ììœ¨ ì£¼í–‰ ì‹œìŠ¤í…œ</strong>ì„ ë§Œë“œëŠ” ì „ ê³¼ì •ì„ ì•ˆë‚´í•˜ëŠ” ì¢…í•© ê°€ì´ë“œì…ë‹ˆë‹¤. ë§ˆì¹˜ JetBotì—ê²Œ ìš´ì „ì„ ê°€ë¥´ì¹˜ëŠ” ê³¼ì •ê³¼ ê°™ì£ ! <span class="emoji">ğŸ‘¨â€ğŸ«</span> <span class="emoji">â¡ï¸</span> <span class="emoji">ğŸ¤–</span></p>
             <p>ì´ 4ê°œì˜ í•µì‹¬ ë‹¨ê³„ë¥¼ ê±°ì¹˜ë©° JetBotì„ ë˜‘ë˜‘í•œ ë“œë¼ì´ë²„ë¡œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤:</p>
             <ol>
                 <li><strong><span class="emoji">ğŸ“¸</span> ë°ì´í„° ìˆ˜ì§‘ (Data Collection):</strong> JetBotì˜ ëˆˆìœ¼ë¡œ ë³¸ ì£¼í–‰ ê²½ë¡œ ì´ë¯¸ì§€ì™€ "ì´ë¦¬ë¡œ ê°€!"ë¼ê³  ì•Œë ¤ì£¼ëŠ” ëª©í‘œ ì§€ì  ë°ì´í„°ë¥¼ ë§Œë“­ë‹ˆë‹¤. ì–‘ì§ˆì˜ ë°ì´í„°ê°€ ë˜‘ë˜‘í•œ AIì˜ ì‹œì‘ì…ë‹ˆë‹¤!</li>
                 <li><strong><span class="emoji">ğŸ§ </span> ëª¨ë¸ í•™ìŠµ (Model Training):</strong> ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ ë”¥ëŸ¬ë‹ ëª¨ë¸(ResNet-18 ê¸°ë°˜)ì—ê²Œ í•™ìŠµì‹œì¼œ, ì´ë¯¸ì§€ ì†ì—ì„œ ìµœì ì˜ ëª©í‘œ ì§€ì ì„ ìŠ¤ìŠ¤ë¡œ ì˜ˆì¸¡í•˜ëŠ” ëŠ¥ë ¥ì„ ê¸¸ëŸ¬ì¤ë‹ˆë‹¤.</li>
                 <li><strong><span class="emoji">âš¡</span> TensorRT ìµœì í™” (TensorRT Optimization):</strong> í•™ìŠµëœ ëª¨ë¸ì„ Jetson Nanoì™€ ê°™ì€ ì—£ì§€ ë””ë°”ì´ìŠ¤ì—ì„œ ë²ˆê°œì²˜ëŸ¼(<span class="emoji">âš¡</span>) ë¹ ë¥´ê²Œ ì‘ë™í•˜ë„ë¡ ë³€í™˜í•˜ê³  ìµœì í™”í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ì£¼í–‰ì˜ í•µì‹¬ì´ì£ !</li>
                 <li><strong><span class="emoji">ğŸš€</span> ì‹¤ì‹œê°„ ë°ëª¨ (Live Demo):</strong> ìµœì í™”ëœ ëª¨ë¸ì„ JetBotì— íƒ‘ì¬í•˜ì—¬, ì‹¤ì‹œê°„ ì¹´ë©”ë¼ ì˜ìƒì„ ë³´ë©° ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•˜ê³  ì£¼í–‰í•˜ëŠ” ë†€ë¼ìš´ ê´‘ê²½ì„ ì§ì ‘ í™•ì¸í•©ë‹ˆë‹¤!</li>
             </ol>
             <p>ì, ì´ì œ JetBotê³¼ í•¨ê»˜ í¥ë¯¸ì§„ì§„í•œ ììœ¨ ì£¼í–‰ì˜ ì„¸ê³„ë¡œ ë– ë‚˜ë³¼ê¹Œìš”?</p>
        </div>
        <hr>
        <!-- Data Collection -->
        <div class="section" id="data-collection">
             <h2><span class="emoji">ğŸ“¸</span> 2. ë°ì´í„° ìˆ˜ì§‘: AIì˜ ëˆˆì„ ìœ„í•œ ì–‘ì‹ ë§Œë“¤ê¸°</h2>
             <p>í›Œë¥­í•œ AI ëª¨ë¸ì„ ë§Œë“¤ë ¤ë©´ ì¢‹ì€ 'ì‹ì¬ë£Œ', ì¦‰ <strong>ë°ì´í„°</strong>ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤. ì´ ë‹¨ê³„ì—ì„œëŠ” JetBotì´ ì§ì ‘ ì£¼í–‰í•  í™˜ê²½ì—ì„œ 'ì–´ë–»ê²Œ ìš´ì „í•´ì•¼ í•˜ëŠ”ì§€'ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ì€ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.</p>
             <h3><span class="emoji">â­</span> 2.1. ëª©í‘œ: ë¬´ì—‡ì„, ì–´ë–»ê²Œ ìˆ˜ì§‘í•˜ë‚˜?</h3>
             <ul>
                 <li>JetBotì˜ ì¹´ë©”ë¼ë¥¼ í†µí•´ ì‹¤ì œ ì£¼í–‰ ê²½ë¡œì˜ ì´ë¯¸ì§€ë¥¼ ìº¡ì²˜í•©ë‹ˆë‹¤.</li>
                 <li>ê° ì´ë¯¸ì§€ë§ˆë‹¤, JetBotì´ ë‹¤ìŒ ìˆœê°„ í–¥í•´ì•¼ í•  <strong>ìµœì ì˜ ëª©í‘œ ì§€ì (x, y í”½ì…€ ì¢Œí‘œ)</strong>ì„ ë§ˆìš°ìŠ¤ í´ë¦­ìœ¼ë¡œ ê¸°ë¡(ë¼ë²¨ë§)í•©ë‹ˆë‹¤.</li>
                 <li><span class="emoji">ğŸ’¡</span> <strong>ë‹¤ì–‘ì„±ì´ ìƒëª…!</strong> ëª¨ë¸ì´ ë‹¤ì–‘í•œ ì‹¤ì œ ìƒí™©ì— ì˜ ëŒ€ì‘í•˜ë„ë¡, ì—¬ëŸ¬ ìœ„ì¹˜, ê°ë„, ì¡°ëª… ì•„ë˜ì—ì„œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. (ì˜ˆ: íŠ¸ë™ ì¤‘ì•™, ê°€ì¥ìë¦¬, ì»¤ë¸Œ ì§„ì…/íƒˆì¶œ ë“±) ìµœì†Œ ìˆ˜ë°± ì¥ ì´ìƒ ìˆ˜ì§‘í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.</li>
             </ul>
             <h3><span class="emoji">ğŸ—ºï¸</span> 2.2. ë¼ë²¨ë§ ê°€ì´ë“œ: "ì–´ë””ë¥¼ ì°ì–´ì•¼ í• ê¹Œìš”?"</h3>
             <p>ì •í™•í•˜ê³  ì¼ê´€ëœ ë¼ë²¨ë§ì€ ëª¨ë¸ ì„±ëŠ¥ì„ ì¢Œìš°í•©ë‹ˆë‹¤. ëª©í‘œ ì§€ì ì„ ì„ íƒí•  ë•Œ ë‹¤ìŒ ê°€ì´ë“œë¼ì¸ì„ ì°¸ê³ í•˜ì„¸ìš”:</p>
             <ol>
                 <li><strong>ì‹¤ì‹œê°„ ì˜ìƒ ì£¼ì‹œ:</strong> Jupyter Labì— í‘œì‹œë˜ëŠ” JetBot ì¹´ë©”ë¼ ì˜ìƒì„ ì£¼ì˜ ê¹Šê²Œ ì‚´í´ë´…ë‹ˆë‹¤.</li>
                 <li><strong>ì´ìƒì ì¸ ê²½ë¡œ ìƒìƒ:</strong> ë¡œë´‡ì´ íŠ¸ë™ ì¤‘ì•™ ë˜ëŠ” íŠ¹ì • ë¼ì¸ì„ ë”°ë¼ ë¶€ë“œëŸ½ê²Œ ë‚˜ì•„ê°€ì•¼ í•  ê²½ë¡œë¥¼ ê·¸ë ¤ë´…ë‹ˆë‹¤.</li>
                 <li><strong>"ê°€ì¥ ë¨¼ ì•ˆì „ ì§€ì " ì„ íƒ:</strong> ë¡œë´‡ì´ í˜„ì¬ ìœ„ì¹˜ì—ì„œ ê·¸ ì§€ì ì„ í–¥í•´ <strong>ì§ì§„í–ˆì„ ë•Œ, ê²½ë¡œë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ê°€ì¥ ë¨¼ ì§€ì </strong>ì„ í´ë¦­í•©ë‹ˆë‹¤.
                     <ul>
                         <li><strong>ì§ì„  êµ¬ê°„:</strong> ì‹œì•¼ê°€ í™•ë³´ë˜ëŠ” í•œ ìµœëŒ€í•œ ë©€ë¦¬ ì°ì–´ë„ ì¢‹ìŠµë‹ˆë‹¤.</li>
                         <li><strong>ì»¤ë¸Œ êµ¬ê°„:</strong> <span class="warning">ì£¼ì˜!</span> ì»¤ë¸Œ ì•ˆìª½ì„ ë”°ë¼ ë„ˆë¬´ ë©€ë¦¬ ì°ìœ¼ë©´ ë¡œë´‡ì´ ê²½ë¡œë¥¼ ì´íƒˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì»¤ë¸Œë¥¼ ì•ˆì „í•˜ê²Œ ëŒ ìˆ˜ ìˆëŠ” ë¹„êµì  ê°€ê¹Œìš´ ì§€ì ì„ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.</li>
                     </ul>
                 </li>
                 <li><strong>ì¼ê´€ì„± ìœ ì§€:</strong> ìì‹ ë§Œì˜ ë¼ë²¨ë§ ê¸°ì¤€ì„ ì •í•˜ê³ , ë°ì´í„° ìˆ˜ì§‘ ë‚´ë‚´ ì¼ê´€ë˜ê²Œ ì ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.</li>
             </ol>
             <blockquote>"Garbage in, garbage out." - ë°ì´í„° ê³¼í•™ì˜ ì˜¤ëœ ê²©ì–¸ì²˜ëŸ¼, ë°ì´í„°ì˜ í’ˆì§ˆì´ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ê²°ì •í•©ë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ë¼ë²¨ë§í•´ì£¼ì„¸ìš”!</blockquote>
             <h3><span class="emoji">ğŸ’»</span> 2.3. êµ¬í˜„ ì½”ë“œ (ë°ì´í„° ìˆ˜ì§‘ ìœ„ì ¯ ì„¤ì •)</h3>
              <p>Jupyter Labì—ì„œ ì‹¤í–‰í•˜ëŠ” Python ì½”ë“œì…ë‹ˆë‹¤. ì¹´ë©”ë¼ ì˜ìƒì„ ë³´ì—¬ì£¼ê³ , ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ì¢Œí‘œì™€ í•¨ê»˜ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>
            <pre><code class="language-python">
# --- í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸ ---
import ipywidgets # Jupyter ìœ„ì ¯
import traitlets # ìœ„ì ¯ ê°„ ì—°ê²°
from IPython.display import display, HTML # Jupyter ë””ìŠ¤í”Œë ˆì´
from jetbot import Robot, Camera, bgr8_to_jpeg # JetBot ë¼ì´ë¸ŒëŸ¬ë¦¬
from uuid import uuid1 # ê³ ìœ  ID ìƒì„±
import os
import glob
import cv2 # OpenCV (ì´ë¯¸ì§€ ì²˜ë¦¬)
import time
from jupyter_clickable_image_widget import ClickableImageWidget # í´ë¦­ ê°€ëŠ¥í•œ ì´ë¯¸ì§€ ìœ„ì ¯

# --- ì„¤ì • ---
DATASET_DIR = 'dataset_xy' # ë°ì´í„° ì €ì¥ ë””ë ‰í† ë¦¬

# --- ë””ë ‰í† ë¦¬ ìƒì„± ---
try:
    os.makedirs(DATASET_DIR)
    print(f"<span class='emoji'>ğŸ“‚</span> '{DATASET_DIR}' ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤.")
except FileExistsError:
    print(f"<span class='emoji'>âœ…</span> '{DATASET_DIR}' ë””ë ‰í† ë¦¬ê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.")

# --- ì¹´ë©”ë¼ ë° ìœ„ì ¯ ì´ˆê¸°í™” ---
camera = Camera(width=224, height=224) # ëª¨ë¸ ì…ë ¥ í¬ê¸°ì— ë§ì¶˜ ì¹´ë©”ë¼
camera_widget = ClickableImageWidget(width=camera.width, height=camera.height) # í´ë¦­ ê°€ëŠ¥í•œ ë¼ì´ë¸Œ ë·°
snapshot_widget = ipywidgets.Image(width=camera.width, height=camera.height) # ì €ì¥ëœ ìŠ¤ëƒ…ìƒ· ë·°
count_widget = ipywidgets.IntText(description='<span class="emoji">ğŸ’¾</span> ì €ì¥ëœ ì´ë¯¸ì§€:', value=0, disabled=True, layout=ipywidgets.Layout(width='200px')) # ì´ë¯¸ì§€ ê°œìˆ˜ í‘œì‹œ

# --- ì¹´ë©”ë¼ ì˜ìƒ ì—°ê²° ---
traitlets.dlink((camera, 'value'), (camera_widget, 'value'), transform=bgr8_to_jpeg)

# --- ì´ˆê¸° ì´ë¯¸ì§€ ê°œìˆ˜ ì—…ë°ì´íŠ¸ ---
count_widget.value = len(glob.glob(os.path.join(DATASET_DIR, '*.jpg')))

# --- ì´ë¯¸ì§€ í´ë¦­ ì‹œ ì‹¤í–‰ë  í•¨ìˆ˜ ---
def save_snapshot(_, content, msg):
    if content['event'] == 'click':
        data = content['eventData']
        x = data['offsetX']
        y = data['offsetY']

        # ê³ ìœ  íŒŒì¼ëª… ìƒì„± (ì¢Œí‘œ í¬í•¨)
        uuid_str = str(uuid1())
        filename = f'xy_{x:03d}_{y:03d}_{uuid_str}.jpg'
        image_path = os.path.join(DATASET_DIR, filename)

        # ì´ë¯¸ì§€ íŒŒì¼ ì €ì¥ (JPEG)
        try:
            with open(image_path, 'wb') as f:
                f.write(camera_widget.value)
        except Exception as e:
            print(f"<span class='emoji'>âŒ</span> ì´ë¯¸ì§€ ì €ì¥ ì˜¤ë¥˜: {e}")
            return # ì˜¤ë¥˜ ë°œìƒ ì‹œ ì¤‘ë‹¨

        # ìŠ¤ëƒ…ìƒ·ì— ë…¹ìƒ‰ ì› í‘œì‹œ
        snapshot = camera.value.copy()
        cv2.circle(snapshot, (x, y), 8, (0, 255, 0), 3) # ë…¹ìƒ‰ ì› (BGR ìˆœì„œ)
        snapshot_widget.value = bgr8_to_jpeg(snapshot)

        # ì´ë¯¸ì§€ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        count_widget.value = len(glob.glob(os.path.join(DATASET_DIR, '*.jpg')))

# --- í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡ ---
camera_widget.on_msg(save_snapshot)

# --- ìœ„ì ¯ ë ˆì´ì•„ì›ƒ ë° í‘œì‹œ ---
data_collection_widget = ipywidgets.VBox([
    HTML("<h2><span class='emoji'>ğŸ–±ï¸</span> ì´ë¯¸ì§€ í´ë¦­ìœ¼ë¡œ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘!</h2>"),
    ipywidgets.HBox([
        ipywidgets.VBox([HTML("<h4>ë¼ì´ë¸Œ ì¹´ë©”ë¼</h4>"), camera_widget]),
        ipywidgets.VBox([HTML("<h4>ì €ì¥ëœ ìŠ¤ëƒ…ìƒ· (í´ë¦­ ì§€ì )</h4>"), snapshot_widget])
    ]),
    count_widget
])

display(data_collection_widget)
print("<span class='emoji'>âœ…</span> ì¹´ë©”ë¼ ë° ìœ„ì ¯ ì¤€ë¹„ ì™„ë£Œ. ë¼ì´ë¸Œ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ì—¬ ë°ì´í„° ìˆ˜ì§‘ì„ ì‹œì‘í•˜ì„¸ìš”!")
            </code></pre>
              <h3><span class="emoji">ğŸ“Š</span> 2.4. ë°ì´í„° í™•ì¸: ìˆ˜ì§‘ ê²°ê³¼ëŠ”?</h3>
             <p>ë°ì´í„° ìˆ˜ì§‘ì„ ì™„ë£Œí•œ í›„, Jupyter Labì˜ íŒŒì¼ ë¸Œë¼ìš°ì €ì—ì„œ <code>dataset_xy</code> í´ë”ë¥¼ ì—´ì–´ë³´ì„¸ìš”. ìˆ˜ë§ì€ <code>xy_<x>_<y>_<uuid>.jpg</code> íŒŒì¼ë“¤ì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒŒì¼ëª…ì— í¬í•¨ëœ <code><x></code>ì™€ <code><y></code> ìˆ«ìê°€ ë°”ë¡œ ì—¬ëŸ¬ë¶„ì´ í´ë¦­í•œ ì†Œì¤‘í•œ ë¼ë²¨ ì •ë³´ì…ë‹ˆë‹¤. ì´ ë°ì´í„°ê°€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ JetBotì˜ 'ì§€ëŠ¥'ì„ ë§Œë“œëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤!</p>
        </div>
        <hr>
        <!-- Model Training -->
        <div class="section" id="model-training">
            <h2><span class="emoji">ğŸ§ </span> 3. ëª¨ë¸ í•™ìŠµ: JetBotì—ê²Œ ìš´ì „ ê°€ë¥´ì¹˜ê¸°</h2>
            <p>ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ì´ìš©í•´ JetBotì˜ 'ë‘ë‡Œ'ê°€ ë  ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ í•™ìŠµì‹œí‚µë‹ˆë‹¤. ëª©í‘œëŠ” ì´ë¯¸ì§€ë¥¼ ë³´ê³ , ìš°ë¦¬ê°€ ì•Œë ¤ì¤€ ì •ë‹µ(ëª©í‘œ ì§€ì  ì¢Œí‘œ)ì„ ìŠ¤ìŠ¤ë¡œ ì˜ˆì¸¡í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤. ì¼ì¢…ì˜ 'ì´ë¯¸ì§€ ë³´ê³  ì¢Œí‘œ ë§ì¶”ê¸°' í›ˆë ¨ì´ì£ !</p>
            <h3><span class="emoji">â­</span> 3.1. í•™ìŠµ ëª©í‘œ</h3>
             <ul>
                 <li>ì…ë ¥ ì´ë¯¸ì§€(224x224)ë¡œë¶€í„° ëª©í‘œ ì§€ì ì˜ ì •ê·œí™”ëœ (x, y) ì¢Œí‘œ [-1, 1] ë²”ìœ„ë¥¼ ì˜ˆì¸¡í•˜ëŠ” <strong>íšŒê·€(Regression)</strong> ëª¨ë¸ì„ ë§Œë“­ë‹ˆë‹¤.</li>
                 <li>ì´ë¯¸ì§€ ì¸ì‹ ë¶„ì•¼ì—ì„œ ê²€ì¦ëœ <strong>ResNet-18</strong> ì•„í‚¤í…ì²˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
                 <li><strong>ì „ì´ í•™ìŠµ(Transfer Learning)</strong> <span class="emoji">ğŸ“</span>: ì´ë¯¸ ë°©ëŒ€í•œ ì´ë¯¸ì§€ ë°ì´í„°(ImageNet)ë¡œ í•™ìŠµëœ ResNet-18 ëª¨ë¸ì„ ê°€ì ¸ì™€, ìš°ë¦¬ì˜ ë„ë¡œ ì£¼í–‰ ë¬¸ì œì— ë§ê²Œ ë§ˆì§€ë§‰ ë¶€ë¶„ë§Œ ë¯¸ì„¸ ì¡°ì •í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì ì€ ë°ì´í„°ë¡œë„ íš¨ê³¼ì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</li>
                 <li>ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ëŠ” <strong>PyTorch</strong>ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
             </ul>
              <h3><span class="emoji">ğŸ› ï¸</span> 3.2. ë°ì´í„°ì…‹ ì¤€ë¹„: í•™ìŠµ ì¬ë£Œ ì†ì§ˆí•˜ê¸°</h3>
             <h4>3.2.1. ì»¤ìŠ¤í…€ ë°ì´í„°ì…‹ í´ë˜ìŠ¤ (<code>XYDataset</code>)</h4>
              <p>PyTorchê°€ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆë„ë¡, ìš°ë¦¬ ë°ì´í„° í˜•ì‹ì— ë§ëŠ” <code>Dataset</code> í´ë˜ìŠ¤ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. ì£¼ìš” ì—­í• ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
             <ul>
                 <li>ì´ë¯¸ì§€ íŒŒì¼ ë¡œë“œ ë° ê²½ë¡œ ê´€ë¦¬</li>
                 <li>íŒŒì¼ëª…ì—ì„œ x, y ì¢Œí‘œ ì¶”ì¶œ ë° [-1, 1] ë²”ìœ„ë¡œ <strong>ì •ê·œí™”</strong></li>
                 <li><strong>ë°ì´í„° ì¦ê°•(Data Augmentation)</strong> ì ìš© (ëª¨ë¸ ê°•ê±´ì„± í–¥ìƒ):
                     <ul>
                         <li><span class="emoji">ğŸ¨</span> <code>ColorJitter</code>: ë°ê¸°, ëŒ€ë¹„ ë“± ë¬´ì‘ìœ„ ë³€ê²½</li>
                         <li><span class="emoji">â†”ï¸</span> <code>Random Horizontal Flip</code>: ë¬´ì‘ìœ„ ì¢Œìš° ë°˜ì „ (í•„ìš”ì‹œ x ì¢Œí‘œ ë¶€í˜¸ ë³€ê²½)</li>
                     </ul>
                 </li>
                 <li>ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • (224x224) ë° PyTorch <strong>í…ì„œ(Tensor)</strong> ë³€í™˜</li>
                 <li>ImageNet ê¸°ë°˜ <strong>ì •ê·œí™”</strong> ì ìš© (í‰ê·  ë¹¼ê³  í‘œì¤€í¸ì°¨ë¡œ ë‚˜ëˆ„ê¸°)</li>
             </ul>
             <pre><code class="language-python">
import torch
import torch.optim as optim
import torch.nn.functional as F
import torchvision
import torchvision.datasets as datasets
import torchvision.models as models
import torchvision.transforms as transforms
import glob
import PIL.Image
import os
import numpy as np

# --- ì¢Œí‘œ ì¶”ì¶œ ë° ì •ê·œí™” í•¨ìˆ˜ ---
def get_x(path, width):
    x_pixel = float(int(os.path.basename(path).split('_')[1]))
    return (x_pixel - width / 2) / (width / 2)

def get_y(path, height):
    y_pixel = float(int(os.path.basename(path).split('_')[2]))
    # Yì¶•ì€ ì•„ë˜ë¡œ ê°ˆìˆ˜ë¡ ê°’ì´ ì»¤ì§€ë¯€ë¡œ, ì •ê·œí™”í•˜ë©´ ìœ„ìª½ì´ -1, ì•„ë˜ìª½ì´ 1ì— ê°€ê¹Œì›€
    return (y_pixel - height / 2) / (height / 2)

# --- ì»¤ìŠ¤í…€ ë°ì´í„°ì…‹ í´ë˜ìŠ¤ ---
class XYDataset(torch.utils.data.Dataset):
    def __init__(self, directory, random_hflips=False):
        self.directory = directory
        self.random_hflips = random_hflips
        self.image_paths = glob.glob(os.path.join(self.directory, '*.jpg'))
        self.color_jitter = transforms.ColorJitter(0.3, 0.3, 0.3, 0.3)
        # ì´ë¯¸ì§€ ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ ì •ì˜
        self.transform = transforms.Compose([
            transforms.Resize((224, 224)),
            transforms.ToTensor(), # PIL -> Tensor, [0,1]
            transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225]) # ImageNet ì •ê·œí™”
        ])

    def __len__(self):
        return len(self.image_paths)

    def __getitem__(self, idx):
        image_path = self.image_paths[idx]
        image = PIL.Image.open(image_path).convert('RGB') # RGBë¡œ ë¡œë“œ
        width, height = image.size
        x = float(get_x(image_path, width))
        y = float(get_y(image_path, height))

        # ë°ì´í„° ì¦ê°• (Augmentation)
        if self.random_hflips and np.random.rand() > 0.5:
            image = transforms.functional.hflip(image)
            x = -x # ì¢Œìš° ë°˜ì „ ì‹œ x ì¢Œí‘œ ë¶€í˜¸ ë°˜ì „!
        image = self.color_jitter(image) # ìƒ‰ìƒ ì¦ê°•

        # ìµœì¢… ì „ì²˜ë¦¬ ì ìš©
        image = self.transform(image)

        return image, torch.tensor([x, y]).float() # ì´ë¯¸ì§€ì™€ ì¢Œí‘œ í…ì„œ ë°˜í™˜

# --- ë°ì´í„°ì…‹ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ---
# dataset = XYDataset(DATASET_DIR, random_hflips=False) # ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” DATASET_DIR ì‚¬ìš©
# print(f"<span class='emoji'>ğŸ“š</span> ë°ì´í„°ì…‹ ë¡œë“œ ì™„ë£Œ! ì´ ì´ë¯¸ì§€: {len(dataset)}") # ì‹¤ì œ í™˜ê²½ì—ì„œ ì£¼ì„ í•´ì œ
            </code></pre>
            <h4>3.2.2. ë°ì´í„° ë¶„í•  ë° ë¡œë” ìƒì„±</h4>
              <p>ì „ì²´ ë°ì´í„°ë¥¼ <strong>í›ˆë ¨ìš©</strong>ê³¼ <strong>í…ŒìŠ¤íŠ¸ìš©</strong>ìœ¼ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤(ì˜ˆ: 90% í›ˆë ¨, 10% í…ŒìŠ¤íŠ¸). <code>DataLoader</code>ëŠ” ë°ì´í„°ë¥¼ ë¯¸ë‹ˆë°°ì¹˜(minibatch) ë‹¨ìœ„ë¡œ ë¬¶ê³  ì„ì–´ì£¼ì–´(<span class="emoji">ğŸ”€</span>) íš¨ìœ¨ì ì¸ í•™ìŠµì„ ë•ìŠµë‹ˆë‹¤.</p>
             <pre><code class="language-python">
# --- ë°ì´í„° ë¶„í•  ---
# test_percent = 0.1
# num_total = len(dataset) # ì‹¤ì œ í™˜ê²½ì—ì„œ dataset ì‚¬ìš©
# num_test = int(test_percent * num_total)
# num_train = num_total - num_test
# train_dataset, test_dataset = torch.utils.data.random_split(dataset, [num_train, num_test])
# print(f"ë°ì´í„° ë¶„í• : í›ˆë ¨ {num_train}ê°œ ({100-test_percent*100:.0f}%), í…ŒìŠ¤íŠ¸ {num_test}ê°œ ({test_percent*100:.0f}%)")

# --- ë°ì´í„° ë¡œë” ìƒì„± ---
# BATCH_SIZE = 8 # ë°°ì¹˜ í¬ê¸° (GPU ë©”ëª¨ë¦¬ ê³ ë ¤)
# train_loader = torch.utils.data.DataLoader(train_dataset, batch_size=BATCH_SIZE, shuffle=True, num_workers=0)
# test_loader = torch.utils.data.DataLoader(test_dataset, batch_size=BATCH_SIZE, shuffle=False, num_workers=0)
# print(f"<span class='emoji'>ğŸ“¦</span> ë°ì´í„° ë¡œë” ìƒì„± ì™„ë£Œ! ë°°ì¹˜ í¬ê¸°: {BATCH_SIZE}")
            </code></pre>
              <h3><span class="emoji">ğŸ—ï¸</span> 3.3. ëª¨ë¸ ì•„í‚¤í…ì²˜ ì •ì˜ (ResNet-18 ìˆ˜ì •)</h3>
              <p>ì‚¬ì „ í•™ìŠµëœ ResNet-18 ëª¨ë¸ì„ ë¶ˆëŸ¬ì™€, ë§ˆì§€ë§‰ ì¶œë ¥ ë ˆì´ì–´ë§Œ (x, y) ì¢Œí‘œ 2ê°œë¥¼ ì¶œë ¥í•˜ë„ë¡ êµì²´í•©ë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ <strong>ì „ì´ í•™ìŠµ</strong>ì˜ ë§ˆë²•!</p>
             <pre><code class="language-python">
# --- ëª¨ë¸ ì •ì˜ ---
model = models.resnet18(pretrained=True) # ImageNet ì‚¬ì „ í•™ìŠµ ê°€ì¤‘ì¹˜ ì‚¬ìš©
num_output_features = 2 # x, y ì¢Œí‘œ 2ê°œ ì¶œë ¥
# ë§ˆì§€ë§‰ ë ˆì´ì–´(fc)ë¥¼ ìƒˆë¡œìš´ Linear ë ˆì´ì–´ë¡œ êµì²´
model.fc = torch.nn.Linear(model.fc.in_features, num_output_features)

# GPU ì‚¬ìš© ì„¤ì •
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = model.to(device)
print(f"<span class='emoji'>âœ…</span> ResNet-18 ëª¨ë¸ ì¤€ë¹„ ì™„ë£Œ! (ì‚¬ìš© ë””ë°”ì´ìŠ¤: {device})")
            </code></pre>
             <h3><span class="emoji">ğŸ‹ï¸</span> 3.4. ëª¨ë¸ í•™ìŠµ ì‹¤í–‰</h3>
             <p>ì´ì œ ì •ì˜ëœ ëª¨ë¸ê³¼ ì¤€ë¹„ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ í•™ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤. <strong>ì˜µí‹°ë§ˆì´ì €(Optimizer)</strong>ëŠ” ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì„ ê²°ì •í•˜ê³ (ì—¬ê¸°ì„œëŠ” Adam ì‚¬ìš©), <strong>ì†ì‹¤ í•¨ìˆ˜(Loss Function)</strong>ëŠ” ëª¨ë¸ì˜ ì˜ˆì¸¡ì´ ì •ë‹µê³¼ ì–¼ë§ˆë‚˜ ë‹¤ë¥¸ì§€ ì¸¡ì •í•©ë‹ˆë‹¤(ì—¬ê¸°ì„œëŠ” MSE Loss ì‚¬ìš©).</p>
             <p>ì—¬ëŸ¬ ë²ˆì˜ <strong>ì—í¬í¬(Epoch)</strong>ë¥¼ ë°˜ë³µí•˜ë©° ëª¨ë¸ì€ ì ì°¨ ì˜¤ì°¨ë¥¼ ì¤„ì—¬ë‚˜ê°€ê³ , í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ í‰ê°€í•˜ì—¬ ê°€ì¥ ì„±ëŠ¥ì´ ì¢‹ì•˜ë˜ ëª¨ë¸ì„ ì €ì¥í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python">
# --- í•™ìŠµ ì„¤ì • ---
NUM_EPOCHS = 70 # ì´ ì—í¬í¬ ìˆ˜ (ì¡°ì ˆ ê°€ëŠ¥)
BEST_MODEL_PATH = 'best_steering_model_xy.pth' # ìµœê³  ëª¨ë¸ ì €ì¥ ê²½ë¡œ
# best_loss = float('inf') # ìµœê³  ì„±ëŠ¥ ê¸°ë¡ìš© (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)

# ì˜µí‹°ë§ˆì´ì € (Adam) ë° ì†ì‹¤ í•¨ìˆ˜ (MSE) ì •ì˜
# optimizer = optim.Adam(model.parameters())
# criterion = torch.nn.MSELoss() # Mean Squared Error Loss

# print(f"<span class='emoji'>ğŸš€</span> ëª¨ë¸ í•™ìŠµ ì‹œì‘! (ì´ ì—í¬í¬: {NUM_EPOCHS})")

# --- í•™ìŠµ ë£¨í”„ (ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì£¼ì„ í•´ì œ í›„ ì‹¤í–‰) ---
# for epoch in range(NUM_EPOCHS):
#     # í›ˆë ¨
#     model.train()
#     running_train_loss = 0.0
#     for images, labels in train_loader:
#         images, labels = images.to(device), labels.to(device) # ë°ì´í„° GPU ì´ë™
#         optimizer.zero_grad() # ê¸°ìš¸ê¸° ì´ˆê¸°í™”
#         outputs = model(images) # ì˜ˆì¸¡
#         loss = criterion(outputs, labels) # ì†ì‹¤ ê³„ì‚°
#         loss.backward() # ì—­ì „íŒŒ (ê¸°ìš¸ê¸° ê³„ì‚°)
#         optimizer.step() # ê°€ì¤‘ì¹˜ ì—…ë°ì´íŠ¸
#         running_train_loss += loss.item() * images.size(0) # ë°°ì¹˜ ì†ì‹¤ ëˆ„ì 

#     epoch_train_loss = running_train_loss / len(train_loader.dataset)

#     # í‰ê°€
#     model.eval()
#     running_test_loss = 0.0
#     with torch.no_grad(): # í‰ê°€ ì‹œ ê¸°ìš¸ê¸° ê³„ì‚° ë¶ˆí•„ìš”
#         for images, labels in test_loader:
#             images, labels = images.to(device), labels.to(device)
#             outputs = model(images)
#             loss = criterion(outputs, labels)
#             running_test_loss += loss.item() * images.size(0)

#     epoch_test_loss = running_test_loss / len(test_loader.dataset)

#     print(f'Epoch [{epoch+1:02d}/{NUM_EPOCHS}], Train Loss: {epoch_train_loss:.6f}, Test Loss: {epoch_test_loss:.6f}')

#     # ìµœê³  ëª¨ë¸ ì €ì¥
#     if epoch_test_loss < best_loss:
#         print(f'  <span class="emoji">âœ¨</span> Test Loss ê°œì„ ! ({best_loss:.6f} -> {epoch_test_loss:.6f}). ëª¨ë¸ ì €ì¥: {BEST_MODEL_PATH}')
#         torch.save(model.state_dict(), BEST_MODEL_PATH)
#         best_loss = epoch_test_loss

# print(f"<span class='emoji'>ğŸ‰</span> ëª¨ë¸ í•™ìŠµ ì™„ë£Œ! ìµœì¢… ìµœê³  Test Loss: {best_loss:.6f}")
            </code></pre>
              <h3><span class="emoji">ğŸ“Š</span> 3.5. í•™ìŠµ ê²°ê³¼: ë˜‘ë˜‘í•´ì§„ JetBotì˜ ë‘ë‡Œ!</h3>
             <p>í•™ìŠµ ë¡œê·¸ë¥¼ í†µí•´ í›ˆë ¨ ì†ì‹¤ê³¼ í…ŒìŠ¤íŠ¸ ì†ì‹¤ì´ ì ì°¨ ê°ì†Œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•™ìŠµì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ë©´, ê°€ì¥ ë‚®ì€ í…ŒìŠ¤íŠ¸ ì†ì‹¤ì„ ê¸°ë¡í•œ ì‹œì ì˜ ëª¨ë¸ ê°€ì¤‘ì¹˜ê°€ <code>best_steering_model_xy.pth</code> íŒŒì¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤. ì´ íŒŒì¼ì´ ë°”ë¡œ TensorRT ìµœì í™” ë‹¨ê³„ì—ì„œ ì‚¬ìš©ë  ê²°ê³¼ë¬¼ì…ë‹ˆë‹¤!</p>
        </div>
        <hr>
        <!-- TensorRT Optimization -->
        <div class="section" id="tensorrt-optimization">
            <h2><span class="emoji">âš¡</span> 4. TensorRT ìµœì í™”: ëª¨ë¸, ë” ë¹ ë¥´ê²Œ!</h2>
              <p>í•™ìŠµëœ PyTorch ëª¨ë¸ì„ Jetson Nanoì™€ ê°™ì€ ì—£ì§€ ë””ë°”ì´ìŠ¤ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ <strong>NVIDIA TensorRT</strong>ë¡œ ìµœì í™”í•©ë‹ˆë‹¤. ëª¨ë¸ì˜ ì—°ì‚° ê·¸ë˜í”„ë¥¼ ë¶„ì„í•˜ê³  ì••ì¶•í•˜ì—¬ ì¶”ë¡  ì†ë„ë¥¼ ë†’ì´ê³ (<span class="emoji">ğŸš€</span>) ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì¤„ì´ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.</p>
             <p>ì—¬ê¸°ì„œëŠ” <code>torch2trt</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ë³€í™˜ ê³¼ì •ì„ ì‰½ê²Œ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
             <h3><span class="emoji">â­</span> 4.1. ìµœì í™” ëª©í‘œ</h3>
             <ul>
                 <li>PyTorch ëª¨ë¸(<code>.pth</code>)ì„ ê³ ì„±ëŠ¥ TensorRT ì—”ì§„ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>
                 <li><code>torch2trt</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ ë³€í™˜ ê³¼ì •ì„ ê°„ì†Œí™”í•©ë‹ˆë‹¤.</li>
                 <li><strong>FP16 (ë°˜ì •ë°€ë„)</strong> ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì¶”ê°€ì ì¸ ì†ë„ í–¥ìƒ ë° ë©”ëª¨ë¦¬ ì ˆì•½ì„ ë‹¬ì„±í•©ë‹ˆë‹¤. (Jetson NanoëŠ” FP16 ì—°ì‚°ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤!)</li>
                 <li>ìµœì í™”ëœ ëª¨ë¸ì„ <code>best_steering_model_xy_trt.pth</code> íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.</li>
             </ul>
             <h3><span class="emoji">ğŸ”§</span> 4.2. <code>torch2trt</code> ì„¤ì¹˜ (í•„ìš”ì‹œ)</h3>
             <p>JetBotì— <code>torch2trt</code>ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, Jetson í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-bash">
# (Jetson Terminalì—ì„œ ì‹¤í–‰)
cd $HOME
git clone https://github.com/NVIDIA-AI-IOT/torch2trt
cd torch2trt
sudo python3 setup.py install
echo "torch2trt ì„¤ì¹˜ ì™„ë£Œ! í„°ë¯¸ë„ ì¬ì‹œì‘ ë˜ëŠ” í™˜ê²½ ì¬ë¡œë“œê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
            </code></pre>
              <h3><span class="emoji">ğŸ”„</span> 4.3. ëª¨ë¸ ë¡œë“œ ë° TensorRT ë³€í™˜</h3>
              <p>í•™ìŠµëœ PyTorch ëª¨ë¸ ê°€ì¤‘ì¹˜(<code>best_steering_model_xy.pth</code>)ë¥¼ ë‹¤ì‹œ ë¡œë“œí•œ í›„, ëª¨ë¸ ì…ë ¥ê³¼ ë™ì¼í•œ í˜•íƒœì˜ 'ë”ë¯¸ ë°ì´í„°'ë¥¼ ë§Œë“¤ì–´ <code>torch2trt</code> í•¨ìˆ˜ì— ì „ë‹¬í•©ë‹ˆë‹¤. ì´ ë”ë¯¸ ë°ì´í„°ëŠ” TensorRTê°€ ëª¨ë¸ì˜ ì—°ì‚° íë¦„ì„ íŒŒì•…í•˜ê³  ìµœì í™”í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
            <pre><code class="language-python">
# import torchvision
# import torch
# from torch2trt import torch2trt, TRTModule # TensorRT ë³€í™˜ ë° ë¡œë“œìš©

# # --- ëª¨ë¸ êµ¬ì¡° ì •ì˜ ë° ê°€ì¤‘ì¹˜ ë¡œë“œ ---
# model = torchvision.models.resnet18(pretrained=False)
# model.fc = torch.nn.Linear(512, 2)
# model.load_state_dict(torch.load('best_steering_model_xy.pth')) # í•™ìŠµëœ ê°€ì¤‘ì¹˜ ë¡œë“œ
# device = torch.device('cuda')
# model = model.cuda().eval().half() # GPU ì´ë™, í‰ê°€ ëª¨ë“œ, FP16 ë³€í™˜
# print("<span class='emoji'>âœ…</span> PyTorch ëª¨ë¸ ë¡œë“œ ë° FP16 ì¤€ë¹„ ì™„ë£Œ.")

# # --- TensorRT ë³€í™˜ìš© ë”ë¯¸ ë°ì´í„° ìƒì„± ---
# dummy_data = torch.zeros((1, 3, 224, 224)).to(device).half() # (ë°°ì¹˜, ì±„ë„, ë†’ì´, ë„ˆë¹„)
# print("<span class='emoji'>ğŸ§ª</span> ë”ë¯¸ ì…ë ¥ ë°ì´í„° ìƒì„± ì™„ë£Œ.")

# # --- TensorRT ë³€í™˜ ì‹¤í–‰ (ì‹œê°„ ì†Œìš”) ---
# print("<span class='emoji'>â³</span> TensorRT ë³€í™˜ ì‹œì‘... (ëª‡ ë¶„ ì •ë„ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)")
# try:
#     model_trt = torch2trt(model, [dummy_data], fp16_mode=True) # FP16 ëª¨ë“œ í™œì„±í™”
#     print("<span class='emoji'>ğŸ‰</span> TensorRT ë³€í™˜ ì„±ê³µ!")
# except Exception as e:
#     print(f"<span class='emoji'>âŒ</span> TensorRT ë³€í™˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
#     # ì˜¤ë¥˜ ë°œìƒ ì‹œ ì´í›„ ì½”ë“œ ì‹¤í–‰ì„ ë§‰ê¸° ìœ„í•´ ì—¬ê¸°ì„œ ì¤‘ë‹¨í•˜ê±°ë‚˜ ì˜ˆì™¸ ì²˜ë¦¬ í•„ìš”
#     raise e

# # --- ìµœì í™”ëœ ëª¨ë¸ ì €ì¥ ---
# TRT_MODEL_PATH = 'best_steering_model_xy_trt.pth'
# torch.save(model_trt.state_dict(), TRT_MODEL_PATH)
# print(f"<span class='emoji'>ğŸ’¾</span> ìµœì í™”ëœ TensorRT ëª¨ë¸ ì €ì¥ ì™„ë£Œ: {TRT_MODEL_PATH}")
            </code></pre>
             <p>ì´ì œ í›¨ì”¬ ê°€ë³ê³  ë¹¨ë¼ì§„(<span class="emoji">âš¡</span>) <code>best_steering_model_xy_trt.pth</code> ëª¨ë¸ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤! ì‹¤ì‹œê°„ ë°ëª¨ì—ì„œ ì´ ëª¨ë¸ì„ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.</p>
        </div>
        <hr>
        <!-- Live Demo -->
        <div class="section" id="live-demo">
            <h2><span class="emoji">ğŸš€</span> 5. ì‹¤ì‹œê°„ ë°ëª¨: JetBot, ë„ë¡œë¥¼ ë‹¬ë¦¬ë‹¤!</h2>
            <p>ë“œë””ì–´ í”„ë¡œì íŠ¸ì˜ í•˜ì´ë¼ì´íŠ¸! ìµœì í™”ëœ TensorRT ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ JetBotì´ ì‹¤ì‹œê°„ ì¹´ë©”ë¼ ì˜ìƒì„ ë³´ë©° ìŠ¤ìŠ¤ë¡œ ë„ë¡œë¥¼ ë”°ë¼ ì£¼í–‰í•˜ëŠ” ë°ëª¨ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. JetBotì´ ì •ë§ë¡œ ë˜‘ë˜‘í•´ì¡ŒëŠ”ì§€ í™•ì¸í•´ë³¼ ì‹œê°„ì…ë‹ˆë‹¤! <span class="emoji">ğŸ¤©</span></p>
            <h3><span class="emoji">â­</span> 5.1. ë°ëª¨ ëª©í‘œ</h3>
            <ul>
                 <li>ìµœì í™”ëœ TensorRT ëª¨ë¸(<code>best_steering_model_xy_trt.pth</code>) ë¡œë“œ</li>
                 <li>ì‹¤ì‹œê°„ ì¹´ë©”ë¼ ì˜ìƒ(<span class="emoji">ğŸ“¹</span>) ì…ë ¥ ë°›ê¸°</li>
                 <li>ì˜ìƒì„ ëª¨ë¸ ì…ë ¥ í˜•ì‹ì— ë§ê²Œ <strong>ì „ì²˜ë¦¬(preprocess)</strong></li>
                 <li>TensorRT ëª¨ë¸ë¡œ ëª©í‘œ (x, y) ì¢Œí‘œ <strong>ì¶”ë¡ (inference)</strong></li>
                 <li>ì¶”ë¡  ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ JetBotì˜ <strong>ì¡°í–¥(steering)</strong> ë° <strong>ì†ë„(speed)</strong> ê³„ì‚° (PD ì œì–´ í™œìš©)</li>
                 <li>ê³„ì‚°ëœ ê°’ìœ¼ë¡œ JetBot ëª¨í„°(<span class="emoji">âš™ï¸</span>)ë¥¼ ì œì–´í•˜ì—¬ ì‹¤ì‹œê°„ ì£¼í–‰!</li>
                 <li>ì‚¬ìš©ìê°€ ì£¼í–‰ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆëŠ” <strong>ìœ„ì ¯ ì¸í„°í˜ì´ìŠ¤</strong> ì œê³µ (<span class="emoji">ğŸ›ï¸</span>)</li>
            </ul>
             <h3><span class="emoji">ğŸ’¾</span> 5.2. TensorRT ëª¨ë¸ ë¡œë“œ</h3>
            <p>ì´ì „ì— ì €ì¥í•œ ìµœì í™”ëœ TensorRT ëª¨ë¸(<code>.pth</code>)ì„ <code>TRTModule</code>ì„ ì‚¬ìš©í•˜ì—¬ ë¡œë“œí•©ë‹ˆë‹¤.</p>
             <pre><code class="language-python">
# import torch
# from torch2trt import TRTModule # TensorRT ëª¨ë¸ ë¡œë“œìš©

# # --- TensorRT ëª¨ë¸ ë¡œë“œ ---
# model_trt = TRTModule()
# TRT_MODEL_PATH = 'best_steering_model_xy_trt.pth'
# try:
#     model_trt.load_state_dict(torch.load(TRT_MODEL_PATH))
#     print(f"<span class='emoji'>âœ…</span> TensorRT ëª¨ë¸ '{TRT_MODEL_PATH}' ë¡œë“œ ì„±ê³µ!")
# except Exception as e:
#     print(f"<span class='emoji'>âŒ</span> TensorRT ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨: {e}")
#     print("   ëª¨ë¸ íŒŒì¼ì´ ì˜¬ë°”ë¥¸ ê²½ë¡œì— ìˆëŠ”ì§€, ë³€í™˜ì´ ì„±ê³µí–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.")
#     # í•„ìš”í•œ ê²½ìš° ì—¬ê¸°ì„œ ì‹¤í–‰ ì¤‘ë‹¨
#     raise e

# device = torch.device('cuda') # GPU ì‚¬ìš© í™•ì¸
# # model_trt = model_trt.to(device) # TRTModuleì€ ë³´í†µ ìë™ìœ¼ë¡œ GPU ì‚¬ìš©
            </code></pre>
             <h3><span class="emoji">ğŸ–¼ï¸â¡ï¸ğŸ§ </span> 5.3. ì´ë¯¸ì§€ ì „ì²˜ë¦¬ í•¨ìˆ˜ ì •ì˜</h3>
             <p>ì¹´ë©”ë¼ ì´ë¯¸ì§€ë¥¼ ëª¨ë¸ì´ ì´í•´í•  ìˆ˜ ìˆëŠ” í˜•ì‹(í…ì„œ, ì •ê·œí™” ë“±)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. í•™ìŠµ ì‹œ ì‚¬ìš©í–ˆë˜ ì „ì²˜ë¦¬ ë°©ì‹ê³¼ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python">
# import torchvision.transforms as transforms
# import torch.nn.functional as F
# import cv2 # OpenCV for color conversion
# import PIL.Image
# import numpy as np

# # --- ì´ë¯¸ì§€ ì „ì²˜ë¦¬ í•¨ìˆ˜ ---
# # ImageNet ì •ê·œí™” íŒŒë¼ë¯¸í„° (GPU, FP16)
# mean = torch.Tensor([0.485, 0.456, 0.406]).cuda().half()
# std = torch.Tensor([0.229, 0.224, 0.225]).cuda().half()

# def preprocess(image_bgr):
#     # BGR (OpenCV) -> RGB (PIL)
#     image_rgb = PIL.Image.fromarray(cv2.cvtColor(image_bgr, cv2.COLOR_BGR2RGB))
#     # PIL -> Tensor, GPU ì´ë™, FP16 ë³€í™˜
#     image_tensor = transforms.functional.to_tensor(image_rgb).to(device).half()
#     # ì •ê·œí™” (mean ë¹¼ê³  stdë¡œ ë‚˜ëˆ„ê¸°)
#     image_tensor.sub_(mean[:, None, None]).div_(std[:, None, None])
#     # ë°°ì¹˜ ì°¨ì› ì¶”ê°€ [C, H, W] -> [1, C, H, W]
#     return image_tensor[None, ...]

# print("<span class='emoji'>âœ…</span> ì´ë¯¸ì§€ ì „ì²˜ë¦¬ í•¨ìˆ˜ 'preprocess' ì •ì˜ ì™„ë£Œ.")
            </code></pre>
              <h3><span class="emoji">ğŸ¤–</span><span class="emoji">ğŸ“·</span> 5.4. ì¹´ë©”ë¼ ë° ë¡œë´‡ ì¸í„°í˜ì´ìŠ¤ ì„¤ì •</h3>
             <p>JetBotì˜ ì¹´ë©”ë¼ì™€ ëª¨í„°ë¥¼ ì œì–´í•˜ê¸° ìœ„í•œ ê°ì²´ë¥¼ ë§Œë“¤ê³ , ì‹¤ì‹œê°„ ì¹´ë©”ë¼ ì˜ìƒì„ Jupyter Labì— í‘œì‹œí•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python">
# from IPython.display import display, HTML
# import ipywidgets
# import traitlets
# from jetbot import Camera, bgr8_to_jpeg, Robot

# # --- ì¹´ë©”ë¼ ë° ë¡œë´‡ ì´ˆê¸°í™” ---
# camera = Camera(width=224, height=224) # í•™ìŠµ ì‹œì™€ ë™ì¼ í¬ê¸°
# robot = Robot() # ëª¨í„° ì œì–´ìš©
# image_widget = ipywidgets.Image(width=camera.width, height=camera.height) # ì˜ìƒ í‘œì‹œ ìœ„ì ¯

# # --- ì¹´ë©”ë¼ ì˜ìƒ ì—°ê²° ---
# traitlets.dlink((camera, 'value'), (image_widget, 'value'), transform=bgr8_to_jpeg)

# # --- ìœ„ì ¯ í‘œì‹œ ---
# display(ipywidgets.VBox([
#     HTML("<h2><span class='emoji'>ğŸ‘€</span> ì‹¤ì‹œê°„ ì¹´ë©”ë¼ ì˜ìƒ</h2>"),
#     image_widget
# ]))
# print("<span class='emoji'>âœ…</span> ì¹´ë©”ë¼ ë° ë¡œë´‡ ê°ì²´ ì¤€ë¹„ ì™„ë£Œ.")
            </code></pre>
              <h3><span class="emoji">ğŸ›ï¸</span> 5.5. ì£¼í–‰ ì œì–´ íŒŒë¼ë¯¸í„° ìŠ¬ë¼ì´ë”</h3>
             <p>JetBotì˜ ì£¼í–‰ ìŠ¤íƒ€ì¼ì„ ë¯¸ì„¸ ì¡°ì •í•˜ê¸° ìœ„í•œ ìŠ¬ë¼ì´ë”ì…ë‹ˆë‹¤. í™˜ê²½ì— ë§ê²Œ ê°’ì„ ì¡°ì ˆí•˜ë©° ìµœì ì˜ ì£¼í–‰ ì„±ëŠ¥ì„ ì°¾ì•„ë³´ì„¸ìš”!</p>
             <ul>
                 <li><span class="emoji">ğŸ’¨</span> <strong>ì†ë„ (Speed):</strong> ê¸°ë³¸ ì£¼í–‰ ì†ë„</li>
                 <li><span class="emoji">ğŸ§­</span> <strong>ì¡°í–¥ ê²Œì¸ (Kp):</strong> ëª©í‘œì™€ì˜ ê°ë„ ì˜¤ì°¨ì— ì–¼ë§ˆë‚˜ ë¯¼ê°í•˜ê²Œ ë°˜ì‘í• ì§€ (ë¹„ë¡€ ì œì–´)</li>
                 <li><span class="emoji">âš–ï¸</span> <strong>ì¡°í–¥ ì•ˆì •ì„± (Kd):</strong> ê¸‰ê²©í•œ ë°©í–¥ ì „í™˜ì„ ì–¼ë§ˆë‚˜ ì–µì œí• ì§€ (ë¯¸ë¶„ ì œì–´, ì§„ë™ ê°ì†Œ)</li>
                 <li><span class="emoji">ğŸ”§</span> <strong>ì¡°í–¥ í¸í–¥ (Bias):</strong> ë¡œë´‡ì´ í•œìª½ìœ¼ë¡œ ì ë¦¬ëŠ” í˜„ìƒ ë³´ì •</li>
             </ul>
             <blockquote class="tip"><span class="emoji">ğŸ’¡</span> <strong>íŠœë‹ íŒ:</strong> ë‚®ì€ ì†ë„ì—ì„œ ì‹œì‘í•˜ì—¬, Kp ê°’ì„ ì¡°ì ˆí•´ ê²½ë¡œë¥¼ ë”°ë¼ê°€ë„ë¡ í•©ë‹ˆë‹¤. ì´í›„ Kd ê°’ì„ ì¡°ê¸ˆì”© ë†’ì—¬ ì§„ë™ì„ ì¡ê³ , í•„ìš”ì‹œ Biasë¡œ ì ë¦¼ í˜„ìƒì„ ë³´ì •í•˜ì„¸ìš”.</blockquote>
             <pre><code class="language-python">
# --- ì œì–´ íŒŒë¼ë¯¸í„° ìŠ¬ë¼ì´ë” ---
# speed_gain_slider = ipywidgets.FloatSlider(min=0.0, max=0.5, step=0.01, value=0.18, description='<span class="emoji">ğŸ’¨</span> ì†ë„', readout_format='.2f')
# steering_gain_slider = ipywidgets.FloatSlider(min=0.0, max=0.5, step=0.005, value=0.08, description='<span class="emoji">ğŸ§­</span> ì¡°í–¥ ê²Œì¸ (Kp)', readout_format='.3f')
# steering_dgain_slider = ipywidgets.FloatSlider(min=0.0, max=0.5, step=0.001, value=0.02, description='<span class="emoji">âš–ï¸</span> ì¡°í–¥ ì•ˆì •ì„± (Kd)', readout_format='.3f')
# steering_bias_slider = ipywidgets.FloatSlider(min=-0.3, max=0.3, step=0.01, value=0.0, description='<span class="emoji">ğŸ”§</span> ì¡°í–¥ í¸í–¥', readout_format='.2f')

# # --- ìŠ¬ë¼ì´ë” í‘œì‹œ ---
# display(ipywidgets.VBox([
#     HTML("<h2><span class='emoji'>âš™ï¸</span> ì£¼í–‰ íŒŒë¼ë¯¸í„° ì¡°ì ˆ</h2>"),
#     speed_gain_slider,
#     steering_gain_slider,
#     steering_dgain_slider,
#     steering_bias_slider
# ]))
            </code></pre>
            <h3><span class="emoji">ğŸ“Š</span> 5.6. ë‚´ë¶€ ìƒíƒœ ì‹œê°í™” ìŠ¬ë¼ì´ë” (ë””ë²„ê¹…ìš©)</h3>
             <p>ëª¨ë¸ì˜ ì˜ˆì¸¡ê°’ê³¼ ìµœì¢… ì œì–´ê°’ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ë©´ ì£¼í–‰ ìƒíƒœë¥¼ ì´í•´í•˜ê³  íŒŒë¼ë¯¸í„°ë¥¼ íŠœë‹í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.</p>
             <pre><code class="language-python">
# --- ë‚´ë¶€ ìƒíƒœ ì‹œê°í™” ìŠ¬ë¼ì´ë” ---
# x_slider = ipywidgets.FloatSlider(min=-1.0, max=1.0, description='ì˜ˆì¸¡ X', disabled=True, readout_format='.2f')
# steering_slider = ipywidgets.FloatSlider(min=-1.0, max=1.0, description='ìµœì¢… ì¡°í–¥', disabled=True, readout_format='.2f')

# # --- ì‹œê°í™” ìŠ¬ë¼ì´ë” í‘œì‹œ ---
# display(ipywidgets.VBox([
#     HTML("<h4><span class='emoji'>ğŸ“ˆ</span> ë‚´ë¶€ ì˜ˆì¸¡ ë° ì œì–´ê°’ (ì°¸ê³ ìš©)</h4>"),
#     x_slider,
#     steering_slider
# ]))
            </code></pre>
            <h3><span class="emoji">ğŸ§ â¡ï¸ğŸš—</span> 5.7. í•µì‹¬ ì‹¤í–‰ í•¨ìˆ˜ (`execute`) ì •ì˜ ë° ì—°ê²°</h3>
              <p>ì¹´ë©”ë¼ì—ì„œ ìƒˆ í”„ë ˆì„ì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ í˜¸ì¶œë˜ì–´, ì´ë¯¸ì§€ ì²˜ë¦¬ â†’ ëª¨ë¸ ì¶”ë¡  â†’ ì œì–´ ê³„ì‚° â†’ ëª¨í„° êµ¬ë™ê¹Œì§€ì˜ ì „ ê³¼ì •ì„ ìˆ˜í–‰í•˜ëŠ” í•µì‹¬ í•¨ìˆ˜ì…ë‹ˆë‹¤. <strong>PD ì œì–´</strong> ë¡œì§ì„ ì‚¬ìš©í•˜ì—¬ ëª©í‘œ ì§€ì ì„ í–¥í•´ ë¶€ë“œëŸ½ê²Œ ì¡°í–¥í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python">
# import numpy as np
# import time

# # --- PD ì œì–´ìš© ë³€ìˆ˜ ---
# angle = 0.0
# angle_last = 0.0

# # --- ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜ ---
# def execute(change):
#     global angle, angle_last # ì „ì—­ ë³€ìˆ˜ ì‚¬ìš© ì„ ì–¸

#     # 1. ìƒˆ ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
#     image = change['new'] # 'new' í‚¤ì— ìƒˆ ì´ë¯¸ì§€ ë°ì´í„°ê°€ ë“¤ì–´ìˆìŒ
#     if image is None: return # ì´ë¯¸ì§€ê°€ ì—†ìœ¼ë©´ ì¤‘ë‹¨

#     try:
#         # 2. ì´ë¯¸ì§€ ì „ì²˜ë¦¬ ë° ëª¨ë¸ ì¶”ë¡ 
#         xy = model_trt(preprocess(image)).detach().float().cpu().numpy().flatten()
#         x = xy[0]
#         y = (0.5 - xy[1]) / 2.0 # yê°’ ë³€í™˜ (ê±°ë¦¬ ê°€ì¤‘ì¹˜ ì—­í• )

#         # 3. ë‚´ë¶€ ìƒíƒœ ì—…ë°ì´íŠ¸ (ì‹œê°í™”ìš©)
#         x_slider.value = float(x)

#         # 4. ì œì–´ íŒŒë¼ë¯¸í„° ê°€ì ¸ì˜¤ê¸°
#         speed_value = speed_gain_slider.value
#         Kp = steering_gain_slider.value
#         Kd = steering_dgain_slider.value
#         bias = steering_bias_slider.value

#         # 5. ëª©í‘œ ê°ë„ ê³„ì‚° (arctan2)
#         # yê°’ì´ ë§¤ìš° ì‘ê±°ë‚˜ 0ì— ê°€ê¹Œì›Œì§€ë©´ angleì´ ë¶ˆì•ˆì •í•´ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì‘ì€ ê°’(epsilon) ë”í•˜ê¸°
#         epsilon = 1e-6
#         angle = np.arctan2(x, y + epsilon)

#         # 6. PD ì œì–´ ê³„ì‚°
#         pid = Kp * angle + Kd * (angle - angle_last)

#         # 7. ìµœì¢… ì¡°í–¥ ê°’ ê³„ì‚° (PD + Bias)
#         steering_value = pid + bias
#         steering_slider.value = float(steering_value) # ì‹œê°í™” ì—…ë°ì´íŠ¸

#         # 8. ì¢Œ/ìš° ëª¨í„° ì†ë„ ê³„ì‚° ë° ë²”ìœ„ ì œí•œ [0.0, 1.0]
#         left_motor_value = max(min(speed_value + steering_value, 1.0), 0.0)
#         right_motor_value = max(min(speed_value - steering_value, 1.0), 0.0)

#         # 9. ëª¨í„° êµ¬ë™
#         robot.left_motor.value = left_motor_value
#         robot.right_motor.value = right_motor_value

#         # 10. í˜„ì¬ ê°ë„ ì €ì¥ (ë‹¤ìŒ ê³„ì‚°ìš©)
#         angle_last = angle

#     except Exception as e:
#         print(f"<span class='emoji'>âŒ</span> ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
#         # ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¡œë´‡ ì •ì§€ ë“±ì˜ ì•ˆì „ ì¡°ì¹˜ ì¶”ê°€ ê°€ëŠ¥
#         # robot.stop()

# # --- ì‹¤í–‰ ì¤€ë¹„ ë° ì‹œì‘ ---
# try:
#     camera.unobserve_all() # ì´ì „ ì½œë°± ëª¨ë‘ í•´ì œ
#     print("<span class='emoji'>ğŸ§¹</span> ì´ì „ ì¹´ë©”ë¼ ì½œë°± ì •ë¦¬ ì™„ë£Œ.")
# except:
#     pass # ì²˜ìŒ ì‹¤í–‰ ì‹œì—ëŠ” ì˜¤ë¥˜ ë°œìƒ ì•ˆ í•¨

# # ì¹´ë©”ë¼ ê°’ ë³€ê²½ ì‹œ execute í•¨ìˆ˜ í˜¸ì¶œí•˜ë„ë¡ ì—°ê²°
# camera.observe(execute, names='value')

# print("<span class='emoji'>ğŸŸ¢</span> ì‹¤ì‹œê°„ ì£¼í–‰ ì‹œìŠ¤í…œ í™œì„±í™”!")
# print("<span class='warning'><span class='emoji'>âš ï¸</span> ê²½ê³ : JetBotì´ ì›€ì§ì…ë‹ˆë‹¤! ì£¼ë³€ ê³µê°„ì„ í™•ì¸í•˜ê³  íŠ¸ë™ ìœ„ì— ë‘ì„¸ìš”!</span>")
# print("   ì£¼í–‰ì„ ë©ˆì¶”ë ¤ë©´ ì•„ë˜ 'ì£¼í–‰ ì¤‘ì§€' ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.")
            </code></pre>
             <h3><span class="emoji">ğŸ›‘</span> 5.8. ì£¼í–‰ ì‹œì‘ ë° ë¹„ìƒ ì •ì§€</h3>
              <p>ìœ„ì˜ ë§ˆì§€ë§‰ ì½”ë“œ ì…€ì„ ì‹¤í–‰í•˜ë©´ JetBotì´ ì£¼í–‰ì„ ì‹œì‘í•©ë‹ˆë‹¤! ìŠ¬ë¼ì´ë”ë¥¼ ì¡°ì ˆí•˜ë©° ìµœì ì˜ ì£¼í–‰ì„ ì°¾ì•„ë³´ì„¸ìš”.</p>
             <blockquote class="warning"><span class="emoji">ğŸš¨</span> <strong>ë¹„ìƒ ì •ì§€:</strong> ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì£¼í–‰ì„ ì¦‰ì‹œ ë©ˆì¶”ê³  ì‹¶ì„ ë•ŒëŠ” ì•„ë˜ ì½”ë“œ ì…€ì„ ì‹¤í–‰í•˜ì„¸ìš”! ì¹´ë©”ë¼ ì—°ê²°ì„ ëŠê³  ëª¨í„°ë¥¼ ì •ì§€ì‹œí‚µë‹ˆë‹¤.</blockquote>
            <pre><code class="language-python">
# --- ì£¼í–‰ ì¤‘ì§€ ì½”ë“œ ---
# print("<span class='emoji'>â³</span> ì£¼í–‰ ì¤‘ì§€ ì‹œë„...")
# try:
#     camera.unobserve(execute, names='value') # ì½œë°± ì—°ê²° í•´ì œ
#     print("<span class='emoji'>ğŸ”Œ</span> ì¹´ë©”ë¼ ì½œë°± ì—°ê²° í•´ì œ ì™„ë£Œ.")
#     time.sleep(0.1) # ì ì‹œ ëŒ€ê¸°
#     robot.stop() # ëª¨í„° ì •ì§€!
#     print("<span class='emoji'>ğŸ›‘</span> ë¡œë´‡ ëª¨í„° ì •ì§€ ì™„ë£Œ.")
#     # camera.stop() # í•„ìš”ì‹œ ì¹´ë©”ë¼ ì •ì§€
# except Exception as e:
#     print(f"<span class='emoji'>â“</span> ì¤‘ì§€ ì¤‘ ì˜¤ë¥˜ ë°œìƒ (ë¬´ì‹œ ê°€ëŠ¥): {e}")

# # ëª¨í„° ê°’ í™•ì¸ (ì •ì§€ë˜ì—ˆëŠ”ì§€)
# print(f"í˜„ì¬ ëª¨í„° ê°’: Left={robot.left_motor.value:.2f}, Right={robot.right_motor.value:.2f}")
            </code></pre>
        </div>
        <hr>
        <!-- Conclusion -->
        <div class="section" id="conclusion">
            <h2><span class="emoji">ğŸ</span> 6. í”„ë¡œì íŠ¸ ì™„ë£Œ ë° í–¥í›„ ê³¼ì œ</h2>
            <p>ì¶•í•˜ë“œë¦½ë‹ˆë‹¤! <span class="emoji">ğŸ¥³</span> ì—¬ëŸ¬ë¶„ì€ ë°ì´í„° ìˆ˜ì§‘ë¶€í„° ëª¨ë¸ í•™ìŠµ, TensorRT ìµœì í™”, ê·¸ë¦¬ê³  ì‹¤ì‹œê°„ ììœ¨ ì£¼í–‰ ë°ëª¨ê¹Œì§€, JetBot ë„ë¡œ ì£¼í–‰ í”„ë¡œì íŠ¸ì˜ ì „ ê³¼ì •ì„ ì„±ê³µì ìœ¼ë¡œ ì™„ìˆ˜í•˜ì…¨ìŠµë‹ˆë‹¤!</p>
            <p>ì´ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ì»´í“¨í„° ë¹„ì „, ë”¥ëŸ¬ë‹ íšŒê·€, ë¡œë´‡ ì œì–´, ì—£ì§€ AI ìµœì í™” ë“± ë‹¤ì–‘í•œ ê¸°ìˆ ì„ ì§ì ‘ ê²½í—˜í•˜ê³  í†µí•©í•˜ëŠ” ëŠ¥ë ¥ì„ í‚¤ìš°ì…¨ê¸°ë¥¼ ë°”ëë‹ˆë‹¤. ì—¬ê¸°ì„œ ì–»ì€ ì§€ì‹ê³¼ ê²½í—˜ì€ ì•ìœ¼ë¡œ ë” ë³µì¡í•˜ê³  í¥ë¯¸ë¡œìš´ AI ë° ë¡œë´‡ ê³µí•™ í”„ë¡œì íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë° í›Œë¥­í•œ ë°‘ê±°ë¦„ì´ ë  ê²ƒì…ë‹ˆë‹¤.</p>
            <p><strong><span class="emoji">ğŸš€</span> ë‹¤ìŒ ë„ì „ ê³¼ì œë“¤:</strong></p>
            <ul>
                <li><strong><span class="emoji">ğŸŒ</span> ë‹¤ì–‘í•œ í™˜ê²½ ì •ë³µ:</strong> ë” ë³µì¡í•œ íŠ¸ë™(êµì°¨ë¡œ, ì˜¤ë¥´ë§‰/ë‚´ë¦¬ë§‰), ì•¼ì™¸ í™˜ê²½, ë‹¤ì–‘í•œ ì¡°ëª… ì¡°ê±´ì—ì„œ ë°ì´í„°ë¥¼ ì¶”ê°€ ìˆ˜ì§‘í•˜ê³  ëª¨ë¸ì˜ ê°•ê±´ì„±ì„ ë”ìš± ë†’ì—¬ë³´ì„¸ìš”.</li>
                <li><strong><span class="emoji">ğŸ’¡</span> ìƒˆë¡œìš´ ëª¨ë¸ ì‹œë„:</strong> ResNet ì™¸ì—ë„ MobileNetV2, EfficientNet-Lite ë“± Jetson í™˜ê²½ì— ë” ì í•©í•œ ê²½ëŸ‰ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì„±ëŠ¥ê³¼ ì†ë„ë¥¼ ë¹„êµ ë¶„ì„í•´ë³´ì„¸ìš”.</li>
                <li><strong><span class="emoji">ğŸ“ˆ</span> ì •êµí•œ ì œì–´ ê¸°ë²•:</strong> PID ì œì–´ì˜ ì ë¶„(I) í•­ì„ ì¶”ê°€í•˜ê±°ë‚˜, ëª¨ë¸ ì˜ˆì¸¡ ë¶ˆí™•ì‹¤ì„±ì„ ê³ ë ¤í•œ ì œì–´, ê²½ë¡œ ê³„íš ì•Œê³ ë¦¬ì¦˜(A*, RRT ë“±)ê³¼ ê²°í•©í•˜ì—¬ ë”ìš± ì•ˆì •ì ì´ê³  ì§€ëŠ¥ì ì¸ ì£¼í–‰ ì œì–´ë¥¼ êµ¬í˜„í•´ë³´ì„¸ìš”.</li>
                <li><strong><span class="emoji">ğŸš¦</span><span class="emoji">ğŸš§</span> ê¸°ëŠ¥ í™•ì¥:</strong> ê°ì²´ ê°ì§€ ëª¨ë¸(ì‹ í˜¸ë“±, í‘œì§€íŒ, ì¥ì• ë¬¼ ì¸ì‹)ê³¼ ê²°í•©í•˜ì—¬, ë‹¨ìˆœí•œ ë¼ì¸ íŠ¸ë ˆì´ì‹±ì„ ë„˜ì–´ ì£¼ë³€ ìƒí™©ì„ ì¸ì§€í•˜ê³  ë°˜ì‘í•˜ëŠ” ì§„ì •í•œ ììœ¨ ì£¼í–‰ ì‹œìŠ¤í…œìœ¼ë¡œ ë°œì „ì‹œì¼œë³´ì„¸ìš”!</li>
            </ul>
            <p>JetBotê³¼ í•¨ê»˜í•˜ëŠ” ì—¬ëŸ¬ë¶„ì˜ AI ì—¬ì •ì„ ì‘ì›í•©ë‹ˆë‹¤! <span class="emoji">ğŸŒŸ</span></p>
        </div>

    </div> <!-- /container -->

    <!-- Three.js ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© (Importmap ì‚¬ìš© - esm.sh CDN) -->
    <script type="importmap">
      {
        "imports": {
          "three": "https://esm.sh/three@0.163.0",
          "three/addons/": "https://esm.sh/three@0.163.0/examples/jsm/"
        }
      }
    </script>

    <!-- 3D ë·°ì–´ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ -->
    <script type="module">
        // í•„ìš”í•œ ëª¨ë“ˆ ì„í¬íŠ¸
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        let scene, camera, renderer, controls, model;
        const container = document.getElementById('viewer-container');
        const loadingIndicator = document.getElementById('loading-indicator');
        // GitHub Raw URLì€ ë¦¬ë‹¤ì´ë ‰ì…˜ ë° CORS ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        // GitHub Pagesë‚˜ ë‹¤ë¥¸ ì •ì  í˜¸ìŠ¤íŒ…ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ì•ˆì •ì ì…ë‹ˆë‹¤.
        // ìš°ì„  jsdelivr CDNì„ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½í•´ë´…ë‹ˆë‹¤. (GitHub Repo ê¸°ë°˜)
        const modelUrl = 'https://cdn.jsdelivr.net/gh/hwkims/jetbot.kr@main/jetbot.glb';

        function init3DViewer() {
            try {
                // --- Scene ---
                scene = new THREE.Scene();
                scene.background = new THREE.Color(0xe9ecef);

                // --- Camera ---
                camera = new THREE.PerspectiveCamera(
                    50, container.clientWidth / container.clientHeight, 0.1, 100
                );
                camera.position.set(1.8, 1.5, 3.0);

                // --- Renderer ---
                renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                renderer.setSize(container.clientWidth, container.clientHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.toneMapping = THREE.ACESFilmicToneMapping;
                renderer.outputColorSpace = THREE.SRGBColorSpace;
                container.appendChild(renderer.domElement);

                // --- Controls ---
                controls = new OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                controls.dampingFactor = 0.08;
                controls.screenSpacePanning = false;
                controls.minDistance = 0.5;
                controls.maxDistance = 10;
                controls.target.set(0, 0.4, 0);
                controls.update();

                // --- Lighting ---
                scene.add(new THREE.AmbientLight(0xffffff, 0.8));
                const hemiLight = new THREE.HemisphereLight( 0xffffff, 0xaaaaaa, 1.0 );
                hemiLight.position.set( 0, 20, 0 );
                scene.add( hemiLight );
                const dirLight = new THREE.DirectionalLight(0xffffff, 2.5);
                dirLight.position.set(5, 10, 7);
                scene.add(dirLight);
                const dirLightBack = new THREE.DirectionalLight(0xffffff, 0.8);
                dirLightBack.position.set(-5, -5, -7);
                scene.add(dirLightBack);

                // --- GLTF Loader ---
                const loader = new GLTFLoader();
                loader.load(
                    modelUrl,
                    // Success
                    function (gltf) {
                        model = gltf.scene;
                        const box = new THREE.Box3().setFromObject(model);
                        const size = box.getSize(new THREE.Vector3());
                        const center = box.getCenter(new THREE.Vector3());
                        const maxDim = Math.max(size.x, size.y, size.z);
                        const scale = 1.8 / maxDim;

                        model.scale.set(scale, scale, scale);
                        model.position.sub(center.multiplyScalar(scale));
                        model.position.y += size.y * scale / 2; // Adjust base to near origin

                        scene.add(model);
                        loadingIndicator.style.display = 'none';
                        console.log('âœ… JetBot 3D ëª¨ë¸ ë¡œë“œ ë° ì„¤ì • ì™„ë£Œ!');
                    },
                    // Progress
                    function (xhr) {
                         if (xhr.lengthComputable) {
                            const percentLoaded = (xhr.loaded / xhr.total) * 100;
                            loadingIndicator.textContent = `â³ ëª¨ë¸ ë¡œë”© ì¤‘... ${Math.round(percentLoaded)}%`;
                        } else {
                             loadingIndicator.textContent = `â³ ëª¨ë¸ ë¡œë”© ì¤‘...`;
                        }
                    },
                    // Error
                    function (error) {
                        console.error('âŒ 3D ëª¨ë¸ ë¡œë“œ ì˜¤ë¥˜:', error);
                        // CORS ê´€ë ¨ ì˜¤ë¥˜ ë©”ì‹œì§€ ì¶”ê°€
                        if (error.message.includes('fetch')) {
                             loadingIndicator.innerHTML = 'ğŸ˜­ ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨!<br/>(CORS ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ê°€ëŠ¥ì„± ë†’ìŒ)';
                        } else {
                             loadingIndicator.innerHTML = 'ğŸ˜­ ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨!<br/>(íŒŒì¼ ê²½ë¡œ ë˜ëŠ” í˜•ì‹ í™•ì¸)';
                        }
                        loadingIndicator.style.color = 'red';
                    }
                );

                // --- Resize Listener ---
                window.addEventListener('resize', onWindowResize, false);

                // --- Animation Loop ---
                animate();

            } catch (error) {
                 console.error("ğŸ’¥ 3D ë·°ì–´ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                 loadingIndicator.innerHTML = 'ğŸ˜­ ë·°ì–´ ì´ˆê¸°í™” ì‹¤íŒ¨!<br/>(ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì˜¤ë¥˜ í™•ì¸)';
                 loadingIndicator.style.color = 'red';
            }
        }

        // Resize Handler
        function onWindowResize() {
            if (!camera || !renderer || !container) return;
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }

        // Animation Loop
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        // Initialize after DOM load
        document.addEventListener('DOMContentLoaded', init3DViewer);

    </script>

</body>
</html>
